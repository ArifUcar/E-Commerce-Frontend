@page "/"
@using E_Commerce_FrontEnd.Models
@using E_Commerce_FrontEnd.Services
@inject HttpClient Http
@inject IProductService ProductService
@inject ICategoryService CategoryService

<!-- Hero Section -->
<div class="hero-section position-relative mb-5">
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="images/slider1.jpg" class="d-block w-100" style="height: 600px; object-fit: cover;" alt="Kampanya 1">
                <div class="carousel-caption text-start">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-6">
                                <h1 class="display-4 fw-bold text-white mb-4">Yeni Sezon İndirimleri</h1>
                                <p class="lead mb-4">Tüm giyim ürünlerinde %50'ye varan indirimler</p>
                                <a href="#" class="btn btn-primary btn-lg px-5 py-3">Hemen Keşfet</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img src="images/slider2.jpg" class="d-block w-100" style="height: 600px; object-fit: cover;" alt="Kampanya 2">
                <div class="carousel-caption text-start">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-6">
                                <h1 class="display-4 fw-bold text-white mb-4">Teknoloji Festivali</h1>
                                <p class="lead mb-4">En yeni teknoloji ürünlerinde süper fırsatlar</p>
                                <a href="#" class="btn btn-primary btn-lg px-5 py-3">Detaylı Bilgi</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</div>

<!-- Özellikler Section -->
<section class="features py-5 bg-light">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-3">
                <div class="feature-item text-center p-4">
                    <i class="bi bi-truck text-primary display-4 mb-3"></i>
                    <h5>Ücretsiz Kargo</h5>
                    <p class="text-muted mb-0">150 TL üzeri alışverişlerde</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="feature-item text-center p-4">
                    <i class="bi bi-shield-check text-primary display-4 mb-3"></i>
                    <h5>Güvenli Ödeme</h5>
                    <p class="text-muted mb-0">256-bit SSL güvenliği</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="feature-item text-center p-4">
                    <i class="bi bi-arrow-counterclockwise text-primary display-4 mb-3"></i>
                    <h5>Kolay İade</h5>
                    <p class="text-muted mb-0">30 gün içinde ücretsiz iade</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="feature-item text-center p-4">
                    <i class="bi bi-headset text-primary display-4 mb-3"></i>
                    <h5>7/24 Destek</h5>
                    <p class="text-muted mb-0">Her zaman yanınızdayız</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Kategoriler -->
<section class="categories py-5">
    <div class="container">
        <div class="section-title text-center mb-5">
            <h2 class="display-6 fw-bold">Popüler Kategoriler</h2>
            <p class="text-muted">İhtiyacınız olan her şey burada</p>
        </div>
        
        @if (categories == null)
        {
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Yükleniyor...</span>
                </div>
            </div>
        }
        else
        {
            <div class="row g-4">
                @foreach (var category in categories.Where(c => !c.IsDeleted))
                {
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="/category/@category.Id" class="category-card text-decoration-none">
                            <div class="card h-100 border-0 shadow-sm text-center hover-scale">
                                <div class="card-body">
                                    <i class="bi bi-grid text-primary display-5 mb-3"></i>
                                    <h6 class="card-title text-dark mb-0">@category.CategoryName</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                }
            </div>
        }
    </div>
</section>

<!-- Öne Çıkan Ürünler -->
<section class="featured-products py-5 bg-light">
    <div class="container">
        <div class="section-title text-center mb-5">
            <h2 class="display-6 fw-bold">Öne Çıkan Ürünler</h2>
            <p class="text-muted">En çok tercih edilen ürünler</p>
        </div>
        
        @if (products == null)
        {
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Yükleniyor...</span>
                </div>
            </div>
        }
        else if (!products.Any())
        {
            <div class="alert alert-info">
                Henüz ürün bulunmamaktadır.
            </div>
        }
        else
        {
            <div class="row g-4">
                @foreach (var product in products)
                {
                    <div class="col-6 col-md-3">
                        <div class="card h-100 border-0 shadow-sm product-card hover-scale">
                            <div class="position-relative">
                                <img src="@(string.IsNullOrEmpty(product.Base64Image) ? 
                                           (string.IsNullOrEmpty(product.ImagePath) ? "images/no-image.jpg" : product.ImagePath) : 
                                           $"data:image/jpeg;base64,{product.Base64Image}")" 
                                     class="card-img-top" 
                                     style="height: 200px; object-fit: cover;"
                                     alt="@product.ProductName">
                                <div class="product-overlay">
                                    <button class="btn btn-sm btn-outline-light me-2" @onclick="() => AddToFavorites(product.Id)">
                                        <i class="bi bi-heart"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-light" @onclick="() => ShowProductDetails(product.Id)">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                </div>
                                @if (product.IsDiscounted)
                                {
                                    <span class="badge bg-danger position-absolute top-0 start-0 m-3">
                                        %@product.DiscountRate İndirim
                                    </span>
                                }
                            </div>
                            <div class="card-body">
                                <h6 class="card-title mb-2">@product.ProductName</h6>
                                <p class="text-muted small mb-2">@(product.Description?.Length > 50 ? product.Description.Substring(0, 47) + "..." : product.Description)</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        @if (product.IsDiscounted)
                                        {
                                            <span class="text-danger fw-bold">@product.DiscountedPrice?.ToString("N2") ₺</span>
                                            <small class="text-muted text-decoration-line-through">@product.Price.ToString("N2") ₺</small>
                                        }
                                        else
                                        {
                                            <span class="fw-bold">@product.Price.ToString("N2") ₺</span>
                                        }
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <small class="text-muted me-2">Stok: @product.StockQuantity</small>
                                        <button class="btn btn-primary btn-sm" @onclick="() => AddToCart(product.Id)">
                                            <i class="bi bi-cart-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</section>

<style>
    .hover-scale {
        transition: transform 0.3s ease;
    }
    .hover-scale:hover {
        transform: scale(1.05);
    }
    
    .product-card .product-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.2);
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .product-card:hover .product-overlay {
        opacity: 1;
    }
</style>

@code {
    private List<Category> categories;
    private List<Product> products;
    
    protected override async Task OnInitializedAsync()
    {
        categories = await CategoryService.GetAllCategories();
        products = await ProductService.GetAllProducts();
    }

    private void AddToFavorites(string productId)
    {
        // Favorilere ekleme işlemi
    }

    private void ShowProductDetails(string productId)
    {
        // Ürün detay sayfasına yönlendirme
    }

    private void AddToCart(string productId)
    {
        // Sepete ekleme işlemi
    }
} 